Backup failed for Site raven.test. Database or site_config.json may be corrupted
Traceback with variables (most recent call last):
  File "apps/frappe/frappe/commands/site.py", line 865, in backup
    odb = scheduled_backup(
      context = CliCtxObj(force=False, profile=False, sites=['raven.test'], verbose=True)
      with_files = False
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_backup_conf = False
      verbose = True
      compress = False
      include = ''
      exclude = ''
      old_backup_metadata = False
      scheduled_backup = <function scheduled_backup at 0x77d5a968cae0>
      exit_code = 0
      rollback_callback = None
      site = 'raven.test'
  File "apps/frappe/frappe/utils/backups.py", line 589, in scheduled_backup
    return new_backup(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = frappe.utils.CallbackManager()
  File "apps/frappe/frappe/utils/backups.py", line 626, in new_backup
    odb = BackupGenerator(
      older_than = 6
      ignore_files = True
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      backup_path_conf = None
      ignore_conf = False
      include_doctypes = ''
      exclude_doctypes = ''
      compress = False
      force = True
      verbose = True
      old_backup_metadata = False
      rollback_callback = frappe.utils.CallbackManager()
  File "apps/frappe/frappe/utils/backups.py", line 89, in __init__
    self.setup_backup_tables()
      self = frappe.utils.backups.BackupGenerator(backup_path=None, backup_path_conf=None, backup_path_db=None, backup_path_files=None, backup_path_private_files=None, compress_files=False, db_host='127.0.0.1', db_name='_04ff0a46898840ad', db_port=3306, db_socket=None, db_type='mariadb', exclude_doctypes='', ignore_conf=False, include_doctypes='', old_backup_metadata=False, partial=False, password='U3b9Zr4pPJfI58Yh', rollback_callback=frappe.utils.CallbackManager(-), site_slug='raven_test', user='_04ff0a46898840ad', verbose=True)
      db_name = '_04ff0a46898840ad'
      user = '_04ff0a46898840ad'
      password = ********
      backup_path = None
      backup_path_db = None
      backup_path_files = None
      backup_path_private_files = None
      db_socket = None
      db_host = '127.0.0.1'
      db_port = 3306
      db_type = 'mariadb'
      backup_path_conf = None
      ignore_conf = False
      compress_files = False
      include_doctypes = ''
      exclude_doctypes = ''
      verbose = True
      old_backup_metadata = False
      rollback_callback = frappe.utils.CallbackManager()
      site = 'raven.test'
  File "apps/frappe/frappe/utils/backups.py", line 126, in setup_backup_tables
    self._set_existing_tables()
      self = frappe.utils.backups.BackupGenerator(backup_path=None, backup_path_conf=None, backup_path_db=None, backup_path_files=None, backup_path_private_files=None, compress_files=False, db_host='127.0.0.1', db_name='_04ff0a46898840ad', db_port=3306, db_socket=None, db_type='mariadb', exclude_doctypes='', ignore_conf=False, include_doctypes='', old_backup_metadata=False, partial=False, password='U3b9Zr4pPJfI58Yh', rollback_callback=frappe.utils.CallbackManager(-), site_slug='raven_test', user='_04ff0a46898840ad', verbose=True)
  File "apps/frappe/frappe/utils/backups.py", line 122, in _set_existing_tables
    self._existing_tables = frappe.db.get_tables()
      self = frappe.utils.backups.BackupGenerator(backup_path=None, backup_path_conf=None, backup_path_db=None, backup_path_files=None, backup_path_private_files=None, compress_files=False, db_host='127.0.0.1', db_name='_04ff0a46898840ad', db_port=3306, db_socket=None, db_type='mariadb', exclude_doctypes='', ignore_conf=False, include_doctypes='', old_backup_metadata=False, partial=False, password='U3b9Zr4pPJfI58Yh', rollback_callback=frappe.utils.CallbackManager(-), site_slug='raven_test', user='_04ff0a46898840ad', verbose=True)
  File "apps/frappe/frappe/database/mariadb/mysqlclient.py", line 519, in get_tables
    .run(pluck=True)
      self = frappe.database.mariadb.mysqlclient.MariaDBDatabase(after_commit=frappe.utils.CallbackManager(-), after_rollback=frappe.utils.CallbackManager(-), auto_commit_on_many_writes=0, before_commit=frappe.utils.CallbackManager(-), before_rollback=frappe.utils.CallbackManager(-), cur_db_name='_04ff0a46898840ad', db_type='mariadb', host='127.0.0.1', logger=<Logger database-raven.test (WARNING)>, password='U3b9Zr4pPJfI58Yh', port=3306, socket=None, transaction_writes=0, type_map={'Currency': ('decimal', '21,9'), 'Int': ('int', '11'), 'Long Int': ('bigint', '20'), 'Float': ('decimal', '21,9'), 'Percent': ('decimal', '21,9'), 'Check': ('tinyint', '4'), 'Small Text': ('text', ''), 'Long Text': ('longte...'), 'Color': ('varchar', 140), 'Barcode': ('longtext', ''), 'Geolocation': ('longtext', ''), 'Duration': ('decimal', '21,9'), 'Icon': ('varchar', 140), 'Phone': ('varchar', 140), 'Autocomplete': ('varchar', 140), 'JSON': ('json', '')}, user='_04ff0a46898840ad', value_cache=collections.defaultdict{})
      cached = True
      to_query = True
      tables = None
      information_schema = pypika.queries.Schema()
  File "apps/frappe/frappe/query_builder/utils.py", line 85, in execute_query
    result = frappe.local.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`=%(param1)s'
      args = ()
      kwargs = {'pluck': True}
      child_queries = "_child_queries"
      params = {'param1': '_04ff0a46898840ad'}
  File "apps/frappe/frappe/database/database.py", line 248, in sql
    self.connect()
      self = frappe.database.mariadb.mysqlclient.MariaDBDatabase(after_commit=frappe.utils.CallbackManager(-), after_rollback=frappe.utils.CallbackManager(-), auto_commit_on_many_writes=0, before_commit=frappe.utils.CallbackManager(-), before_rollback=frappe.utils.CallbackManager(-), cur_db_name='_04ff0a46898840ad', db_type='mariadb', host='127.0.0.1', logger=<Logger database-raven.test (WARNING)>, password='U3b9Zr4pPJfI58Yh', port=3306, socket=None, transaction_writes=0, type_map={'Currency': ('decimal', '21,9'), 'Int': ('int', '11'), 'Long Int': ('bigint', '20'), 'Float': ('decimal', '21,9'), 'Percent': ('decimal', '21,9'), 'Check': ('tinyint', '4'), 'Small Text': ('text', ''), 'Long Text': ('longte...'), 'Color': ('varchar', 140), 'Barcode': ('longtext', ''), 'Geolocation': ('longtext', ''), 'Duration': ('decimal', '21,9'), 'Icon': ('varchar', 140), 'Phone': ('varchar', 140), 'Autocomplete': ('varchar', 140), 'JSON': ('json', '')}, user='_04ff0a46898840ad', value_cache=collections.defaultdict{})
      query = 'SELECT `table_name` FROM `information_schema`.`tables` WHERE `table_schema`=%(param1)s'
      values = {'param1': '_04ff0a46898840ad'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = True
      as_iterator = False
      query_type = 'select'
  File "apps/frappe/frappe/database/database.py", line 146, in connect
    self.get_connection()
      self = frappe.database.mariadb.mysqlclient.MariaDBDatabase(after_commit=frappe.utils.CallbackManager(-), after_rollback=frappe.utils.CallbackManager(-), auto_commit_on_many_writes=0, before_commit=frappe.utils.CallbackManager(-), before_rollback=frappe.utils.CallbackManager(-), cur_db_name='_04ff0a46898840ad', db_type='mariadb', host='127.0.0.1', logger=<Logger database-raven.test (WARNING)>, password='U3b9Zr4pPJfI58Yh', port=3306, socket=None, transaction_writes=0, type_map={'Currency': ('decimal', '21,9'), 'Int': ('int', '11'), 'Long Int': ('bigint', '20'), 'Float': ('decimal', '21,9'), 'Percent': ('decimal', '21,9'), 'Check': ('tinyint', '4'), 'Small Text': ('text', ''), 'Long Text': ('longte...'), 'Color': ('varchar', 140), 'Barcode': ('longtext', ''), 'Geolocation': ('longtext', ''), 'Duration': ('decimal', '21,9'), 'Icon': ('varchar', 140), 'Phone': ('varchar', 140), 'Autocomplete': ('varchar', 140), 'JSON': ('json', '')}, user='_04ff0a46898840ad', value_cache=collections.defaultdict{})
  File "apps/frappe/frappe/database/mariadb/mysqlclient.py", line 109, in get_connection
    conn = self._get_connection()
      self = frappe.database.mariadb.mysqlclient.MariaDBDatabase(after_commit=frappe.utils.CallbackManager(-), after_rollback=frappe.utils.CallbackManager(-), auto_commit_on_many_writes=0, before_commit=frappe.utils.CallbackManager(-), before_rollback=frappe.utils.CallbackManager(-), cur_db_name='_04ff0a46898840ad', db_type='mariadb', host='127.0.0.1', logger=<Logger database-raven.test (WARNING)>, password='U3b9Zr4pPJfI58Yh', port=3306, socket=None, transaction_writes=0, type_map={'Currency': ('decimal', '21,9'), 'Int': ('int', '11'), 'Long Int': ('bigint', '20'), 'Float': ('decimal', '21,9'), 'Percent': ('decimal', '21,9'), 'Check': ('tinyint', '4'), 'Small Text': ('text', ''), 'Long Text': ('longte...'), 'Color': ('varchar', 140), 'Barcode': ('longtext', ''), 'Geolocation': ('longtext', ''), 'Duration': ('decimal', '21,9'), 'Icon': ('varchar', 140), 'Phone': ('varchar', 140), 'Autocomplete': ('varchar', 140), 'JSON': ('json', '')}, user='_04ff0a46898840ad', value_cache=collections.defaultdict{})
  File "apps/frappe/frappe/database/mariadb/mysqlclient.py", line 114, in _get_connection
    return self.create_connection()
      self = frappe.database.mariadb.mysqlclient.MariaDBDatabase(after_commit=frappe.utils.CallbackManager(-), after_rollback=frappe.utils.CallbackManager(-), auto_commit_on_many_writes=0, before_commit=frappe.utils.CallbackManager(-), before_rollback=frappe.utils.CallbackManager(-), cur_db_name='_04ff0a46898840ad', db_type='mariadb', host='127.0.0.1', logger=<Logger database-raven.test (WARNING)>, password='U3b9Zr4pPJfI58Yh', port=3306, socket=None, transaction_writes=0, type_map={'Currency': ('decimal', '21,9'), 'Int': ('int', '11'), 'Long Int': ('bigint', '20'), 'Float': ('decimal', '21,9'), 'Percent': ('decimal', '21,9'), 'Check': ('tinyint', '4'), 'Small Text': ('text', ''), 'Long Text': ('longte...'), 'Color': ('varchar', 140), 'Barcode': ('longtext', ''), 'Geolocation': ('longtext', ''), 'Duration': ('decimal', '21,9'), 'Icon': ('varchar', 140), 'Phone': ('varchar', 140), 'Autocomplete': ('varchar', 140), 'JSON': ('json', '')}, user='_04ff0a46898840ad', value_cache=collections.defaultdict{})
  File "apps/frappe/frappe/database/mariadb/mysqlclient.py", line 117, in create_connection
    return MySQLdb.connect(**self.get_connection_settings())
      self = frappe.database.mariadb.mysqlclient.MariaDBDatabase(after_commit=frappe.utils.CallbackManager(-), after_rollback=frappe.utils.CallbackManager(-), auto_commit_on_many_writes=0, before_commit=frappe.utils.CallbackManager(-), before_rollback=frappe.utils.CallbackManager(-), cur_db_name='_04ff0a46898840ad', db_type='mariadb', host='127.0.0.1', logger=<Logger database-raven.test (WARNING)>, password='U3b9Zr4pPJfI58Yh', port=3306, socket=None, transaction_writes=0, type_map={'Currency': ('decimal', '21,9'), 'Int': ('int', '11'), 'Long Int': ('bigint', '20'), 'Float': ('decimal', '21,9'), 'Percent': ('decimal', '21,9'), 'Check': ('tinyint', '4'), 'Small Text': ('text', ''), 'Long Text': ('longte...'), 'Color': ('varchar', 140), 'Barcode': ('longtext', ''), 'Geolocation': ('longtext', ''), 'Duration': ('decimal', '21,9'), 'Icon': ('varchar', 140), 'Phone': ('varchar', 140), 'Autocomplete': ('varchar', 140), 'JSON': ('json', '')}, user='_04ff0a46898840ad', value_cache=collections.defaultdict{})
  File "env/lib/python3.12/site-packages/MySQLdb/__init__.py", line 121, in Connect
    return Connection(*args, **kwargs)
      args = ()
      kwargs = {'user': '_04ff0a46898840ad', 'conv': {<class 'int'>: <function Thing2Str at 0x77d5a8b33d80>, <class 'float'>: <function Float2Str at 0x77d5a8b33e20>, <class 'NoneType'>: <function None2NULL at 0x77d5a8b33ec0>, <class 'array.array'>: <function array2Str at 0x77d5a8b7c0e0>, <class 'bool'>: <function Bool2Str at 0x77d5a8b33c40>, <class 'datetime.date'>: <function Thing2Literal at 0x77d5a8b33f60>, <class 'datetime.datetime'>: <function DateTime2literal at 0x77d5a8b337e0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x77d5a8b7cea0>, <class 'set'>: <function Set2Str at 0x77d5a8b33ce0>, <class 'decimal.Decimal'>: <function Decimal2Literal at 0x77d5a8b7c040>, 1: <class 'int'>, 2: <c...<class 'bytes'>, 245: <class 'bytes'>, <class 'dict'>: <function escape_dict at 0x77d5a8b7cf40>, <class 'frozenset'>: <function escape_frozenset at 0x77d5a8b32980>}, 'charset': 'utf8mb4', 'use_unicode': True, 'database': '_04ff0a46898840ad', 'host': '127.0.0.1', 'port': 3306, 'password': '********'}
      Connection = MySQLdb.connections.Connection
  File "env/lib/python3.12/site-packages/MySQLdb/connections.py", line 200, in __init__
    super().__init__(*args, **kwargs2)
      self = <_mysql.connection open to '(null)' at 0xf327470>
      args = ()
      kwargs = {'user': '_04ff0a46898840ad', 'conv': {<class 'int'>: <function Thing2Str at 0x77d5a8b33d80>, <class 'float'>: <function Float2Str at 0x77d5a8b33e20>, <class 'NoneType'>: <function None2NULL at 0x77d5a8b33ec0>, <class 'array.array'>: <function array2Str at 0x77d5a8b7c0e0>, <class 'bool'>: <function Bool2Str at 0x77d5a8b33c40>, <class 'datetime.date'>: <function Thing2Literal at 0x77d5a8b33f60>, <class 'datetime.datetime'>: <function DateTime2literal at 0x77d5a8b337e0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x77d5a8b7cea0>, <class 'set'>: <function Set2Str at 0x77d5a8b33ce0>, <class 'decimal.Decimal'>: <function Decimal2Literal at 0x77d5a8b7c040>, 1: <class 'int'>, 2: <c...<class 'bytes'>, 245: <class 'bytes'>, <class 'dict'>: <function escape_dict at 0x77d5a8b7cf40>, <class 'frozenset'>: <function escape_frozenset at 0x77d5a8b32980>}, 'charset': 'utf8mb4', 'use_unicode': True, 'database': '_04ff0a46898840ad', 'host': '127.0.0.1', 'port': 3306, 'password': '********'}
      CLIENT = <module 'MySQLdb.constants.CLIENT' from 'env/lib/python3.12/site-packages/MySQLdb/constants/CLIENT.py'>
      FIELD_TYPE = <module 'MySQLdb.constants.FIELD_TYPE' from 'env/lib/python3.12/site-packages/MySQLdb/constants/FIELD_TYPE.py'>
      conversions = {<class 'int'>: <function Thing2Str at 0x77d5a8b33d80>, <class 'float'>: <function Float2Str at 0x77d5a8b33e20>, <class 'NoneType'>: <function None2NULL at 0x77d5a8b33ec0>, <class 'array.array'>: <function array2Str at 0x77d5a8b7c0e0>, <class 'bool'>: <function Bool2Str at 0x77d5a8b33c40>, <class 'datetime.date'>: <function Thing2Literal at 0x77d5a8b33f60>, <class 'datetime.datetime'>: <function DateTime2literal at 0x77d5a8b337e0>, <class 'datetime.timedelta'>: <function DateTimeDelta2literal at 0x77d5a8b33880>, <class 'set'>: <function Set2Str at 0x77d5a8b33ce0>, <class 'decimal.Decimal'>: <function Decimal2Literal at 0x77d5a8b7c040>, 1: <class 'int'>, 2: <class 'int'>, 3: <class 'int'>, 4:...r_None at 0x77d5a8b33560>, 11: <function TimeDelta_or_None at 0x77d5a8b33600>, 10: <function Date_or_None at 0x77d5a8b33740>, 249: <class 'bytes'>, 250: <class 'bytes'>, 251: <class 'bytes'>, 252: <class 'bytes'>, 254: <class 'bytes'>, 253: <class 'bytes'>, 15: <class 'bytes'>, 245: <class 'bytes'>}
      _bytes_or_str = ((128, bytes), (None, str))
      kwargs2 = {'user': '_04ff0a46898840ad', 'conv': {<class 'int'>: <function Thing2Str at 0x77d5a8b33d80>, <class 'float'>: <function Float2Str at 0x77d5a8b33e20>, <class 'NoneType'>: <function None2NULL at 0x77d5a8b33ec0>, <class 'array.array'>: <function array2Str at 0x77d5a8b7c0e0>, <class 'bool'>: <function Bool2Str at 0x77d5a8b33c40>, <class 'datetime.date'>: <function Thing2Literal at 0x77d5a8b33f60>, <class 'datetime.datetime'>: <function DateTime2literal at 0x77d5a8b337e0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x77d5a8b7cea0>, <class 'set'>: <function Set2Str at 0x77d5a8b33ce0>, <class 'decimal.Decimal'>: <function Decimal2Literal at 0x77d5a8b7c040>, 1: <class 'int'>, 2: <c...lass 'bytes'>, 245: <class 'bytes'>, <class 'dict'>: <function escape_dict at 0x77d5a8b7cf40>, <class 'frozenset'>: <function escape_frozenset at 0x77d5a8b32980>}, 'charset': 'utf8mb4', 'database': '_04ff0a46898840ad', 'host': '127.0.0.1', 'port': 3306, 'password': '********', 'client_flag': 196608}
      conv = {<class 'int'>: <function Thing2Str at 0x77d5a8b33d80>, <class 'float'>: <function Float2Str at 0x77d5a8b33e20>, <class 'NoneType'>: <function None2NULL at 0x77d5a8b33ec0>, <class 'array.array'>: <function array2Str at 0x77d5a8b7c0e0>, <class 'bool'>: <function Bool2Str at 0x77d5a8b33c40>, <class 'datetime.date'>: <function Thing2Literal at 0x77d5a8b33f60>, <class 'datetime.datetime'>: <function DateTime2literal at 0x77d5a8b337e0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x77d5a8b7cea0>, <class 'set'>: <function Set2Str at 0x77d5a8b33ce0>, <class 'decimal.Decimal'>: <function Decimal2Literal at 0x77d5a8b7c040>, 1: <class 'int'>, 2: <class 'int'>, 3: <class 'int'>, 4: <cla...249: <class 'bytes'>, 250: <class 'bytes'>, 251: <class 'bytes'>, 252: <class 'bytes'>, 254: <class 'bytes'>, 253: <class 'bytes'>, 15: <class 'bytes'>, 245: <class 'bytes'>, <class 'dict'>: <function escape_dict at 0x77d5a8b7cf40>, <class 'frozenset'>: <function escape_frozenset at 0x77d5a8b32980>}
      conv2 = {<class 'int'>: <function Thing2Str at 0x77d5a8b33d80>, <class 'float'>: <function Float2Str at 0x77d5a8b33e20>, <class 'NoneType'>: <function None2NULL at 0x77d5a8b33ec0>, <class 'array.array'>: <function array2Str at 0x77d5a8b7c0e0>, <class 'bool'>: <function Bool2Str at 0x77d5a8b33c40>, <class 'datetime.date'>: <function Thing2Literal at 0x77d5a8b33f60>, <class 'datetime.datetime'>: <function DateTime2literal at 0x77d5a8b337e0>, <class 'datetime.timedelta'>: <function escape_timedelta at 0x77d5a8b7cea0>, <class 'set'>: <function Set2Str at 0x77d5a8b33ce0>, <class 'decimal.Decimal'>: <function Decimal2Literal at 0x77d5a8b7c040>, 1: <class 'int'>, 2: <class 'int'>, 3: <class 'int'>, 4: <cla...249: <class 'bytes'>, 250: <class 'bytes'>, 251: <class 'bytes'>, 252: <class 'bytes'>, 254: <class 'bytes'>, 253: <class 'bytes'>, 15: <class 'bytes'>, 245: <class 'bytes'>, <class 'dict'>: <function escape_dict at 0x77d5a8b7cf40>, <class 'frozenset'>: <function escape_frozenset at 0x77d5a8b32980>}
      k = frozenset
      v = <function escape_frozenset at 0x77d5a8b32980>
      cursorclass = MySQLdb.cursors.Cursor
      charset = 'utf8mb4'
      collation = ''
      use_unicode = True
      sql_mode = ''
      client_flag = 196608
      multi_statements = True
      autocommit = False
      __class__ = MySQLdb.connections.Connection
MySQLdb.OperationalError: (1698, "Access denied for user '_04ff0a46898840ad'@'localhost'")
